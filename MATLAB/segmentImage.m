function [BW,maskedImage] = segmentImage(RGB)
%segmentImage Segment image using auto-generated code from Image Segmenter app
%  [BW,MASKEDIMAGE] = segmentImage(RGB) segments image RGB using
%  auto-generated code from the Image Segmenter app. The final segmentation
%  is returned in BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 10-Dec-2022
%----------------------------------------------------


% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Graph cut
foregroundInd = [23443 23806 34779 34783 43851 43898 43902 43911 43928 43937 43941 53009 53273 64366 65645 73330 74605 74631 82398 83724 93738 93915 94079 94935 95077 103972 111878 113247 123213 123218 123460 124315 124596 132285 133676 133681 133685 141690 142411 150425 150585 151795 151803 161761 161765 162314 162340 162370 162759 171282 171502 171528 171792 172194 179905 180268 180272 180289 180669 180700 180799 180829 181248 191240 191595 191599 192584 200636 200714 201652 209384 209574 209842 210711 220720 221238 222042 222051 230133 230401 230449 230475 230557 231105 238864 239162 239663 240164 240281 250442 250459 250481 251072 259272 260170 260542 269294 279684 280664 280867 280893 289771 289784 289892 298160 298903 298916 310589 327307 356791 357115 378629 386271 386595 415751 416070 475030 483786 504198 533678 592642 603165 613050 631189 672009 681077 699221 710556 750594 758180 787655 817135 876090 905570 935049 984937 1023488 1043896 1062040 1084003 1091520 1161823 1191303 1220783 1249571 1288818 1365922 1395402 1415809 1417408 1454361 1513325 1533732 1553492 1563212 1622171 1660723 1740086 1759880 1778642 1827924 1846673 1955528 2016177 2075145 2091600 2130151 2170975 2181745 2200455 2248079 2270197 2277558 2297970 2327450 2366002 2375070 2395482 2434029 2456182 2463513 2483921 2513400 2533808 2553706 2563292 2610911 2640395 2651230 2669875 2728839 2749246 2767386 2796870 2817278 2867165 2878030 2885305 2923856 2955142 2964672 3003223 3023631 3053111 3054934 3071250 3100730 3112070 3121138 3141550 3150622 3159690 3171030 3180102 3189169 3198241 3209581 3218653 3227721 3257205 3270394 3277613 3286685 3298020 3298025 3307092 3316164 3345644 3366056 3367918 3386464 3395536 3404608 3425011 3434079 3445414 3445419 3454486 3483966 3493038 3513446 3513450 3522518 3531590 3542930 3551997 3552002 3561069 3561078 3572409 3572418 3581477 3590549 3590558 3601889 3601898 3620037 3621934 3640449 3669933 3710386 3747045 3776529 3798842 3817353 3826425 3846837 3876326 3878222 3894470 3935298 3953442 3964782 3973854 3982926 3994266 4003338 4012410 4021482 4032822 4062302 4062781 4062807 4062811 4062824 4062833 4062863 4062881 4062894 4071374 4071784 4071793 4071806 4071814 4071832 4071845 4071978 4071983 4072017 4072039 4072048 4072091 4072112 4072160 4072186 4072212 4072220 4072242 4072268 4072277 4080446 4080770 4080778 4080791 4080817 4080830 4080847 4081357 4081366 4081379 4081387 4081396 4081409 4081426 4081906 4081953 4081966 4081979 4081988 4091781 4092023 4092036 4092049 4092054 4092066 4092075 4092079 4092092 4092779 4092827 4092857 4092870 4092892 4092900 4092930 4092943 4092961 4092974 4092995 4093008 4093047 4093060 4093069 4093121 4093134 4093164 4093207 4093229 4100853 4101078 4101087 4102422 4102426 4109925 4110137 4111506 4111511 4111826 4121455 4121460 4122855 4122859 4130337 4130514 4130523 4131944 4131949 4139561 4139569 4139574 4141029 4150749 4150896 4152378 4159821 4159938 4159951 4161454 4168893 4169001 4180233 4180315 4180324 4180333 4181879 4189305 4189379 4190956 4198377 4198434 4209717 4209752 4209756 4209761 4209765 4211372 4218789 4227861 4239201 4249928 4257350 4268690 4297560 4317972 4356528 4356770 4367868 4406429 4435913 4465634 4474469 4515530 4533437 4545014 4562925 4574498 4583337 4631198 4642538 4660682 4671789 4681094 4701277 4730761 4760245 4760474 4789729 4807873 4808102 4857769 4858003 4875913 4916737 4926047 4934881 4955293 4974025 4983097 4992169 4992195 4993849 5003509 5003535 5012611 5014261 5021687 5033027 5034673 5042065 5042099 5051171 5053059 5062477 5062511 5073225 5080660 5092000 5101033 5101072 5102709 5110144 5121484 5123121 5130556 5141265 5148700 5160040 5160044 5169116 5178145 5179821 5189528 5191157 5191161 5191420 5198600 5200229 5207672 5220636 5228045 5229704 5238776 5250116 5250388 5257529 5257572 5259184 5266644 5277941 5279591 5287056 5288655 5288659 5296133 5297722 5307425 5307473 5309062 5309356 5316545 5318130 5318134 5325569 5325617 5327202 5336909 5338538 5346029 5347605 5355053 5356677 5375465 5375513 5384537 5384585 5386144 5386148 5386468 5395925 5397475 5397480 5404949 5406534 5406539 5414069 5415602 5423093 5423141 5424657 5424666 5424674 5425024 5434481 5435988 5445034 5445052 5452577 5452625 5454093 5454102 5463917 5465412 5465420 5472989 5473041 5474471 5474475 5482061 5482113 5483530 5483534 5493401 5494840 5494857 5502529 5503899 5503907 5504404 5511545 5511601 5512949 5524242 5524250 5524259 5524272 5531957 5532013 5533283 5533288 5533296 5533305 5541090 5541379 5541383 5541388 5541392 5541396 5541401 5541405 5541409 5541414 5541422 5541426 5541439 5541444 5541448 5541452 5541461 5541465 5541470 5541483 5541487 5541491 5541509 5542208 5542226 5542234 5542243 5542256 5542265 5542278 5542286 5542303 5542316 5542325 5542956 5552369 5552430 5552719 5552853 5552896 5552905 5552918 5552922 5552935 5552939 5552948 5552957 5552965 5552974 5552991 5552995 5553535 5561791 5562072 5562076 5562085 5562089 5562093 5562102 5562106 5562573 5562582 5562586 5570513 5570574 5570578 5570863 5571187 5571209 5571217 5571222 5571239 5571247 5571256 5571291 5571304 5571628 5571636 5581853 5581918 5582203 5582657 5582674 5582937 5582955 5582963 5583780 5590925 5590990 5591966 5591979 5591996 5599997 5600066 5600844 5600852 5600861 5600870 5600874 5600887 5600904 5600909 5600917 5600922 5600930 5600939 5600947 5600969 5600982 5600999 5601008 5601025 5601030 5601924 5611337 5611683 5620409 5620755 5629481 5629550 5640821 5641167 5649893 5649966 5650239 5658965 5659038 5659306 5670305 5672232 5679455 5688449 5688790 5697599 5697862 5699448 5708865 5708943 5709202 5717937 5719860 5727009 5727346 5738349 5738427 5747421 5747503 5747758 5756493 5758416 5767833 5767915 5768170 5776910 5776987 5777242 5786064 5786314 5797322 5806394 5815466 5815552 5826892 5827138 5835882 5835968 5844954 5845282 5846868 5865366 5865457 5874529 5886102 5894854 5894945 5903931 5904017 5915361 5915586 5917176 5924347 5933505 5944850 5945066 5953831 5953922 5962907 5962994 5971979 5972070 5983410 5983617 5985216 5992391 5992482 5992685 6001757 6012898 6013093 6021880 6021970 6030952 6031042 6031228 6031232 6042387 6042391 6042564 6051368 6051463 6060440 6060539 6060544 6060699 6071884 6071888 6072022 6072030 6072035 6080852 6080960 6080964 6080969 6080973 6080977 6080982 6080986 6080990 6080994 6080999 6081003 6081007 6081012 6081016 6081020 6081025 6081038 6081051 6081064 6103156 6110340 6130752 6148901 6169313 6189725 6198797 6228285 6237357 6257769 6266841 6287253 6289136 6296329 6298213 6305401 6316741 6325813 6334885 6346225 6355297 6364369 6384786 6405198 6414270 6416119 6425229 6434682 6464166 6493654 6502726 6532210 6550354 6570770 6600254 6602082 6620666 6629738 6638814 6650154 6652042 6659226 6668298 6679638 6697782 6699606 6709127 6718199 6727271 6768095 6786243 6795315 6815731 6836143 6854292 6867438 6883776 6904188 6924604 6942748 6944550 6963160 6965022 6992644 7022132 7033006 7042544 7090177 7101098 7119661 7121458 7140073 7187701 7200838 7228525 7258009 7277963 7277967 7287497 7298371 7298405 7307455 7327855 7335125 7346020 7364609 7366436 7385021 7386853 7395929 7395933 7403165 7404997 7405010 7416298 7416307 7416358 7423577 7443993 7532450 7534264 7543319 7550594 7571006 7572816 7581875 7602287 7602291 7602295 7602330 7648122 7649898 7649949 7677606 7707090 7708909 7729342 7747918 7766062 7767868 7777402 7786474 7795546 7797313 7806891 7808692 7815963 7825035 7836375 7845447 7847244 7854519 7854523 7856350 7865863 7874935 7884007 7897140 7904419 7913495 7933907 7952056 7953870 7963396 7981544 8001956 8011032 8033220 8040516 8099489 8112600 8112630 8130701 8140313 8169797 8217429 8246913 8276397 8287236 8296809 8298533 8314953 8328090 8335369 8355781 8364853 8373925 8387028 8394342 8423826 8444238 8455025 8462386 8482798 8484547 8500946 8512286 8514053 8530434 8543515 8571263 8582089 8589411 8600751 8609823 8609827 8639311 8659723 8677872 8689212 8690931 8698284 8699969 8707356 8729487 8738563 8747597 8757256 8775400 8797493 8797527 8804884 8816224 8817935 8825296 8826977 8845708 8847419 8854780 8863852 8865563 8875192 8876903 8885975 8893336 8895047 8906430 8913748 8922820 8924496 8934160 8935910 8943232 8952304 8952390 8952412 8952416 8954045 8963644 8963709 8963718 8963761 8972716 8972764 8972841 8974392 8974453 8981788 8981827 8981931 8981944 8982004 8993128 8993154 8993163 8993353 9002200 9002217 9002455 9002468 9003881 9003919 9011272 9011276 9011281 9011285 9011570 9011587 9011600 9011609 9012966 9012979 9012983 9020698 9020703 9020716 9020737 9020746 9020759 9020772 9020776 9020798 9020806 9020819 9020832 9020845 9020871 9020884 9020897 9032267 9032280 9032293 9033442 9041387 9041400 9050485 9051582 9061851 9061872 9062641 9062659 9062689 9062706 9062719 9062732 9062767 9070970 9071696 9071847 9071860 9071990 9080055 9080699 9080712 9080725 9080733 9080746 9080772 9080785 9080803 9080833 9080941 9081057 9091408 9091412 9091438 9091451 9091469 9091490 9091520 9091538 9091555 9091585 9091602 9091615 9091637 9091667 9092013 9092017 9092026 9092039 9092190 9092380 9092384 9100804 9100843 9101297 9101314 9101331 9101357 9101400 9101439 9101448 9109993 9110438 9110446 9110451 9110459 9110464 9110468 9110481 9110490 9110494 9110503 9121380 9121436 9121838 9130569 9140012 ];
backgroundInd = [52689 73097 93509 111649 132056 150196 200079 229559 268106 317998 327066 347478 356550 367885 406437 435921 454061 474473 494880 513020 553840 571984 583319 601463 630766 642106 642283 660423 680835 710146 710314 719386 739794 769274 778346 807661 857717 875861 896273 916521 925753 964304 993788 1014200 1043680 1073004 1091308 1111720 1161612 1179756 1200168 1220580 1268203 1288460 1288615 1306759 1318095 1365723 1395056 1395207 1415619 1445099 1465511 1494844 1504062 1533546 1551690 1572098 1592510 1621852 1631066 1651474 1669618 1690026 1699098 1739917 1758061 1778469 1787541 1807953 1817021 1866912 1875980 1884927 1885052 1896388 1944007 1955343 1973487 2002962 2014302 2023266 2032437 2052845 2073257 2120876 2141284 2159467 2170807 2179745 2179836 2179875 2179879 2188903 2188947 2209311 2209359 2218426 2229723 2229766 2238838 2247906 2277390 2288682 2288726 2297754 2306870 2327277 2336306 2347689 2356718 2356761 2374901 2374905 2386241 2395274 2395313 2404381 2424758 2445200 2445205 2454242 2454272 2463228 2463314 2463344 2474684 2483726 2492824 2504138 2504164 2513210 2513245 2522308 2533652 2542724 2551766 2563132 2572178 2572200 2581272 2601662 2601679 2610756 2621975 2622074 2631159 2631168 2649290 2660634 2669702 2669719 2699203 2728687 2737759 2749099 2758171 2767243 2778579 2796723 2808063 2817135 2837543 2875969 2885171 2935067 2964417 2964551 2994030 3003102 3023514 3041654 3041658 3052994 3061932 3062066 3091550 3100488 3100618 3121030 3159452 3159582 3179994 3189061 3209473 3218420 3227617 3248025 3268437 3306993 3327401 3345424 3345545 3395441 3415853 3424804 3433992 3454404 3472548 3531395 3560875 3560992 3590476 3601695 3610888 3631179 3631295 3660779 3669735 3678923 3699335 3708407 3737891 3767254 3805927 3835411 3846630 3876235 3905598 3935203 3953347 3973759 4032602 4032727 4050871 4080225 4091695 4121179 4139193 4150663 4168807 4189219 4198291 4218703 4257259 4268469 4269290 4269294 4269299 4269303 4269312 4269316 4269329 4269338 4277671 4278271 4278276 4278280 4278284 4278289 4278293 4278306 4278310 4278315 4278323 4278328 4278336 4278345 4278418 4287266 4287274 4287283 4287300 4287305 4287313 4287318 4287326 4287335 4287508 4287516 4295815 4296277 4296282 4296294 4296303 4296307 4296325 4296597 4296606 4296614 4307531 4307535 4307544 4307552 4307561 4307570 4307583 4307587 4307600 4307609 4307963 4307971 4307980 4307984 4316227 4316586 4316594 4317065 4317069 4317074 4317091 4317095 4317104 4317113 4325169 4325640 4325649 4326202 4326210 4326219 4326223 4326258 4326267 4326275 4326284 4326288 4336959 4337654 4337671 4337684 4337697 4337710 4346018 4346813 4346826 4346830 4346838 4346847 4346856 4346864 4346877 4346890 4346895 4346903 4346925 4346934 4346942 4355064 4355068 4355077 4356027 4356031 4356036 4356040 4356044 4356053 4356062 4356079 4356092 4356096 4356114 4356122 4356131 4356139 4356157 4356161 4366127 4366382 4366391 4366395 4367510 4367514 4367523 4367531 4375441 4376608 4376625 4376638 4384496 4384505 4385736 4395827 4397089 4397097 4397106 4404683 4404843 4404847 4404852 4404860 4404869 4404878 4406191 4406195 4406200 4413855 4413868 4413872 4413876 4413889 4413894 4413898 4415276 4415280 4415285 4425190 4425195 4425199 4426633 4426638 4426642 4434262 4434267 4435722 4443239 4443334 4444799 4444812 4454674 4456156 4463746 4465232 4474313 4474317 4484154 4485662 4493001 4494734 4502298 4513634 4515154 4524226 4543118 4553715 4561257 4572381 4572597 4574131 4583207 4590664 4590741 4601351 4620221 4630840 4640633 4651256 4658777 4660060 4660069 4660073 4660082 4660086 4660095 4660099 4669905 4671387 4671439 4671668 4680515 4688188 4688261 4689125 4689134 4689147 4689164 4689173 4689194 4689207 4689216 4689497 4689592 4699601 4700448 4700582 4700590 4708600 4709485 4709502 4709667 4709671 4709675 4709887 4710012 4710228 4717745 4718549 4718756 4719084 4729012 4729085 4729871 4729880 4730109 4730118 4730273 4730429 4739198 4739207 4739215 4739224 4739323 4739509 4739712 4747156 4747229 4747998 4748313 4748322 4748331 4748339 4748352 4748586 4758496 4758569 4759329 4767641 4767952 4767956 4768393 4769002 4769196 4776640 4776713 4776722 4776730 4776743 4776761 4776769 4776774 4776782 4776786 4776791 4776795 4776799 4776804 4776808 4776817 4776821 4776825 4776830 4778078 4778268 4788174 4788178 4788381 4788390 4788792 4789422 4789608 4797255 4798499 4798680 4806331 4806538 4806927 4807575 4817468 4817887 4818021 4818025 4818030 4818034 4818038 4818915 4818919 4819092 4826747 4827089 4827093 4827110 4827114 4827991 4828164 4835819 4836044 4836156 4836191 4836394 4846952 4847159 4847492 4847535 4847539 4856236 4856460 4856611 4857648 4865541 4865627 4865692 4865696 4865852 4865856 4866720 4874168 4874384 4874617 4874622 4874695 4874773 4874777 4874781 4874915 4874920 4875792 4885966 4886026 4886126 4886251 4886255 4894580 4894796 4895051 4895098 4895206 4895215 4895310 4895314 4903872 4904136 4904140 4904149 4904162 4904166 4904291 4904296 4904369 4904373 4904378 4915649 4915657 4915696 4916616 4924284 4924734 4924738 4924742 4924746 4924751 4924755 4924764 4933136 4933356 4934760 4944333 4944696 4955172 4962840 4964244 4975584 4983032 4983252 5003664 5005068 5012516 5014140 5021808 5023212 5032928 5034552 5042220 5051072 5051292 5052696 5064036 5071704 5080556 5093525 5100825 5102597 5111669 5121600 5123009 5130452 5132081 5139744 5150220 5150225 5159936 5160156 5161560 5170632 5178080 5178300 5178577 5178585 5178594 5178616 5178629 5178659 5178676 5178702 5178728 5178741 5178758 5178806 5178823 5178849 5178862 5178875 5178883 5178901 5178914 5178935 5178948 5178970 5178978 5178991 5179004 5179696 5189277 5189882 5189886 5189904 5189908 5190357 5190366 5190383 5190388 5191027 5198492 5198928 5198933 5198946 5199468 5200095 5207784 5207979 5207983 5207992 5208558 5208570 5209154 5209162 5219267 5219271 5219275 5219288 5219293 5219301 5219306 5219932 5219941 5219954 5219967 5220485 5220489 5228317 5228322 5228326 5228330 5228334 5229060 5229069 5229078 5229086 5229535 5229540 5229544 5237368 5237376 5237381 5238184 5238197 5238348 5238370 5238383 5238400 5238409 5238426 5238439 5238452 5238461 5238478 5238486 5238495 5238504 5238512 5238521 5238543 5238551 5238564 5238573 5238577 5238582 5238586 5238603 5248388 5248608 5248699 5248703 5248708 5249550 5249580 5249593 5249606 5249641 5249654 5249662 5249675 5257771 5266839 5277872 5278092 5278174 5296236 5296310 5307645 5316428 5316717 5325357 5325785 5325789 5337125 5346132 5346197 5355265 5366544 5375396 5375672 5384744 5395665 5396024 5396084 5405156 5414228 5423240 5423300 5434580 5434640 5443652 5443712 5452784 5464064 5464124 5472777 5473196 5493332 5493548 5493608 5511692 5523032 5531888 5541241 5552300 5561372 5561588 5561653 5570444 5570660 5570729 5581784 5582000 5582069 5591141 5599785 5599928 5600148 5611488 5611553 5620340 5629632 5629697 5640972 5650113 5659121 5679533 5697309 5697750 5708796 5709021 5718162 5727165 5727238 5738509 5738578 5747650 5747655 5756727 5767769 5768067 5777074 5777139 5785761 5786146 5786211 5797490 5797551 5806562 5815638 5815690 5826983 5827026 5836055 5836098 5845131 5845161 5856475 5856480 5856484 5856488 5856497 5865293 5874213 5992301 6030857 6060189 6071681 6101160 6139716 6178268 6198537 6228164 6257562 6257566 6257570 6257575 6257579 6257583 6266629 6305272 6346096 6375580 6414136 6434548 6443481 6464032 6502588 6532072 6561560 6570489 6620532 6638676 6650016 6697644 6708984 6738321 6756612 6806513 6824505 6845069 6874553 6883473 6895012 6904084 6913113 6913156 6924496 6933568 6942441 6942640 6953937 6953980 6963052 6972124 6983464 6992493 6992536 7001608 7012948 7021821 7022020 7031092 7042393 7042432 7051504 7060576 7069648 7080837 7080954 7080984 7089909 7090056 7098981 7099128 7110321 7119397 7119531 7128469 7128474 7128582 7128599 7139814 7139818 7139822 7139827 7148903 7148911 7149006 7157910 7157992 7157996 7169410 7178421 7178447 7207810 7237299 7257866 7266783 7305343 7305498 7344059 7384727 7393955 7423443 7432360 7502827 7550455 7570716 7579944 7638916 7647833 7668400 7697888 7727372 7765933 7795253 7806757 7836241 7865565 7865725 7883869 7922425 7933605 7972325 8001813 8040374 8081198 8090270 8110513 8110686 8140170 8178730 8217291 8237707 8246598 8285154 8285339 8314823 8326163 8355647 8373791 8394022 8394203 8403275 8423506 8432578 8432759 8443918 8444099 8453171 8462062 8471315 8482655 8491550 8500622 8521034 8521211 8550695 8559767 8570935 8571107 8600591 8609491 8609663 8618735 8630075 8648047 8648215 8659555 8677699 8689039 8727591 8745735 8766147 8786554 8816038 8834182 8845522 8863666 8884078 8893150 8922630 8933970 8943042 8952114 8963454 8972526 8981598 8992934 9002006 9011078 9020150 9031490 ];
L = superpixels(X,45823,'IsInputLab',true);

% Convert L*a*b* range to [0 1]
scaledX = prepLab(X);
BW = lazysnapping(scaledX,L,foregroundInd,backgroundInd);

% Create masked image.
maskedImage = RGB;
maskedImage(repmat(~BW,[1 1 3])) = 0;
end

function out = prepLab(in)

% Convert L*a*b* image to range [0,1]
out = in;
out(:,:,1) = in(:,:,1) / 100;  % L range is [0 100].
out(:,:,2) = (in(:,:,2) + 86.1827) / 184.4170;  % a* range is [-86.1827,98.2343].
out(:,:,3) = (in(:,:,3) + 107.8602) / 202.3382;  % b* range is [-107.8602,94.4780].

end
